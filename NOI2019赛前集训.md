# NOI2019赛前集训

UPD：19/6/11 开始了一个大坑：）

## 6.11

### A.标记的连接图

​	~~简单的dp~~，发现所有状态都可以若干层。于是设$f_{i,j}$表示由$i$个点组成的图中，最后一层由$j$个点组成的图的个数，$g_{i,j}$表示.....所有点到跟的距离和。转移就是考虑连接这一层点和上一层点，还有新加的点互相连，最后答案要乘$(n-2)!$。

### B.游戏

​	北京集训时写过，顺便补上题解。先把两个数组排序，然后二分答案。现在图变成了一个二分图，问题变成了二分图博弈问题。现在问题变成$(a_1,b_1)$在不在二分图里面，不好做。二分图最大匹配=点数-二分图最大独立集。要求的就是$(a_1,b_1)$不在某一个最大独立集中。求最大独立集就是相当于找一个划分点，这个点左上方所有的黑点个数+右下方所有白点个数。

### C.脑部进食

​	很容易就可以想到$O((n|s_1||s_2|)^3)$的高消做法。然后发现转移方程的最后一维是分层的，于是可以做到$O((n|s_1|)^3|s_2|)​$。

## 6.12

### A.集合

​	$k=2$可以$O(n^2)$做。

​	$k=3，k=4$要推容斥系数。发现$F$的系数要么是0要么是1，所以可以$n^2$预处理每一段区间，它们是由若干个一次函数叠加起来的，然后就可以方便区间求和。预处理完后就可以双指针处理所有函数。我把每种情况都写了一个函数，相当麻烦。

### B.棋盘

​	~~咕咕咕~~

​	搞出来了。结论就是阶梯nim的结论。但是当$k$为偶数，且特殊棋子在第二位的时候要特判。

### C.序列

​	场上怎么就没想出来？？（被SA搞了，以后还是乖乖想SAM吧）

​	后缀树的形态不会变，变的只是某些点的儿子的顺序。发生的变化只有$O(N)$种，发生变化的点的个数是$N​$。于是平衡树维护dfs序。没了

## 6.14

### A.算法

​	每个点对染色方案数的贡献是$n-与它相邻的编号大于它的点数$，考虑维护每个点的贡献。拿set维护每个点的出边，从小到大做启发式合并。

### B.Triangular Lamp

​	atcoder原题，可以把所有点都转移到$x+y=C$的直线上，这个图是和初始图是等价的，然后把一个点转移到每一条直线的图画出来，是一个模2下的杨辉三角，每一行的最后一位和第一位一定是亮的，如果我们能找到这两个点，就一定能找到初始的那个点。

​	我们在研究一下这个杨辉三角的性质，发现它是一个谢尔宾斯基三角形。根据谢尔宾斯基三角形的性质，如果我们找到某个黑点，我们就能每次跳2的k次方找到最左边和最右边。问题转为如何找到一个黑点。

​	为了找到这个黑点，我们需要利用这个式子：
$$
\exists k,\Sigma_{x\ mod\ 3=k}\binom{n}{x}\equiv 1(mod\ 2)
$$
​	然后可以递归做，每次找到mod 2=1的那边。求这个式子显然是一个数位dp。

复杂度：$O(Nlog^2MAX)$。

### C.Hatto Nero

​	二维数据结构sb题。

## 6.15

### A. 智慧树(tree)

​	循环卷积板子题，bluestein做。
$$
\begin{align}
F(\omega^i)&=\Sigma_{j=0}^{n-1}f_j\omega^{ij}\\
&=\Sigma_{j=0}^{n-1}f_j\omega^{\frac{(i+j)^2-i^2-j^2}{2}}
\end{align}
$$

### B.组合数(combination)

​	数位dp加容斥，可以优化到3的n次方。第一次会从小到大地dp。

### C.(string)

​	数据结构题。

​	分三种情况做。

​	第一种是找到每个$a_i​$是最大值的极大区间，做三维数点。

​	第二种是二分询问区间的最小的满足条件的前缀。

​	第二种是二分询问区间的最小的满足条件的后缀。

​	找到一段区间最f值，可以SAM+启发式合并做。

​	时空复杂度都是$O(nlog^2n)$。

​	还有一种每次在线段树插入最大值的做法by yww。

## 6.17

### A.Multiple of Nine

​	题目中的约束相当于让数列中若干个位置的前缀和模9同余。我们把这几个约束的位置提出来，如果这几个位置的值是确定的，那么这个数列的方案是可以算出来的，是$\Pi_ival_i$，其中val是每两个空之间填数的方案数($0\to10^L-1$中模9余k的数的个数)。

​	子集卷积可以完成。$O(8*3^Q)$。

### B.Paths

​	先数出三元环和四元环，然后分类讨论容斥一下。$O(M\sqrt M)$。

### C.Distinct Boxes

​	http://192.168.102.138/JudgeOnline/viewsolution.php?cid=1603&pid=2

## 6.18

### A. 无向图(graph)

​	分治加按秩合并dsu，两个log正解。

​	lct一个log暴力

### B.线段树(segment)

​	发现操作序列可以预处理，于是可以莫队+点分治。

### C.玩游戏(game)

​	乱搞，维护01区间。

## 6.19

### A.[序列计数](http://192.168.102.138/JudgeOnline/problem.php?cid=1605&pid=0)

​	先算有序的，枚举最小值和公比，公比是$\frac{p}{q}$，是最小值和最大值的比值是平方级的，所以一定可以在根号复杂度下完成。

### B.[苹果](http://192.168.102.138/JudgeOnline/problem.php?cid=1605&pid=1)

​	容斥，dp带容斥系数的。转移可以mlog预处理。

### C.[斐波拉契数串](http://192.168.102.138/JudgeOnline/problem.php?cid=1605&pid=2)

​	我乱搞过的。

## 6.21

### A.[以武装革命颠覆相互强制性价值观之必要性与其实际执行手法](http://192.168.102.138/JudgeOnline/problem.php?cid=1606&pid=0)

​	不会

### B.[革命性宣传计划之始末与阶级性愤怒](http://192.168.102.138/JudgeOnline/problem.php?cid=1606&pid=1)

​	把（当2，把）当-1时，所有前缀和恒不小于0，反过来则所有后缀恒不小于0。预处理所有（往后能匹配到的最远位置，）往前能匹配到的最远位置。这样用线段树加扫描线就可以做完。

​	具体做法就是，对所有（在遇到它的时候在线段树中加入它，然后在pos处把它删掉。对于），相当于对一段区间加上这段区间中还在线段树上的（的个数。学到了

### C.[对于透过大规模仪式进行之恋爱生物间共名的实践与其粉碎方式](http://192.168.102.138/JudgeOnline/problem.php?cid=1606&pid=2)

​	树剖加线段树维护分治ntt。每次修改相当于把$F(x)$变成$F(cx)$。然后递归处理线段树子树的所有点，每次只pushup访问到的点，这样时间复杂度每次修改nlogn的。

## 6.23

### A.[A](http://192.168.102.138/JudgeOnline/problem.php?cid=1607&pid=0)

​	模拟费用流。

### B.[B](http://192.168.102.138/JudgeOnline/problem.php?cid=1607&pid=1)

​	场上就觉得可以在线，可以想hide那题一样$O(1)$合并两个区间的答案，但是我想的是维护c的值，没想出来怎么处理。场后发现这题确实可以在线不过维护的是t，qwq。大概就是每段区间维护lmx，rmx，ans，sum。

### C.[C](http://192.168.102.138/JudgeOnline/problem.php?cid=1607&pid=2)

​	把主串s和所有单词一起放进AC自动机里，按bfs序在AC自动机上计算每个节点的答案。对每个节点我们用一个数据结构维护这个节点表示的字符串中以每个位置为左端点的单词的价值和。遍历到一个节点时，它fail树上的父亲和trie树上的父亲都已经计算过了，用支持快速合并的数据结构维护一下即可。时空复杂度都是一个log。直接复制的。